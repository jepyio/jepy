var jepy=function(){"use strict";class t{render(){}}class e extends t{#t;#e;#s;constructor(t,e,s){super(),this.#t=t,this.#e=e,this.#s=s}render(t){return this.#t(t)?this.#e.render(t):this.#s?this.#s.render(t):""}}const s=".",n=":",r=(t,e)=>t.includes(s)?t.split(s).reduce(((t,e)=>t?.[e]),e):e[t];class c extends t{#n;#r;#c;#i;constructor(t,e,s,n=""){super(),this.#n=t,this.#c=e,this.#i=s,this.#r=n}render(t){let e=r(this.#n,t);return this.#r&&(e=e.map((t=>Object.defineProperty({},this.#r,{value:t})))),e.map((e=>{const s=this.#i?this.#i(e,t):e;return this.#c.render(Object.assign(s,t))})).join("")}}class i extends t{#h;constructor(t){super(),this.#h=t}render(){return this.#h}}class h extends t{#o;#a;#l=null;constructor(t,e){super(),this.#o=t,this.#a=e||(()=>!0)}render(t){return null!==this.#l&&this.#a(t,this)||(this.#l=this.#o.render(t)),this.#l}}const o={SPACE:" ",TAB:"\t"};class a extends t{#u;#d;#p;constructor(t,e,s){super(),this.#u=t,this.#d=e,this.#p=s}render(t){const e=this.#u.render(t),s=e.split("\n");return s.length>1?s.map((t=>this.#b(t))).join("\n"):this.#b(e)}#b(t){return t.padStart(this.#p+t.length,this.#d)}}const l="$",u="%",d={REPEATING:"#",CONDITIONAL:"?",TAB_INDENTED:">",SPACE_INDENTED:"_",CACHED:"="},p="{",b="}",k="!",w="@";class C{#h="";#k={};#w=!1;constructor(t,e={}){this.#h=t,this.#k=e}render(t={}){this.#w||this.#C();let e=this.#h;const n=(t,n)=>{const r=new RegExp("\\"+t+"\\"+p+"(?<path>\\"+w+"?\\w+(?:\\"+s+"(\\w|\\_\\-)+)*)\\"+b,"g"),c=e.matchAll(r);for(const t of c)e=e.replaceAll(t[0],n(t.groups.path))};return n(u,(e=>this.#f(e,t))),n(l,(e=>{const s=this.#f(e,t);return"string"==typeof s?this.#x(s):s})),e}#f(t,e){return t.startsWith(w)?this.#E(t,e):r(t,e)}#E(e,s){const n=e.slice(1);let c=r(n,this.#k);"function"==typeof c&&(c=c(s));return"object"==typeof c&&c instanceof t?c.render(s):c}#x(t){return t.replace(/([<>&]|[^#-~| |!])/g,(t=>"&#"+t.charCodeAt(0)+";")).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,(t=>"&#"+(1024*t.charCodeAt(0)+t.charCodeAt(1)-56613888)+";"))}#C(){const t=Object.values(d).map((t=>"\\"+t)),e=new RegExp("(?<prefix>["+t.join("")+"])\\"+p+"(?<operator>[\\"+k+"])?(?<placeholder>(?<name>\\"+w+"?\\w+(?:\\"+s+"\\w+)*)(?:\\"+n+"[\\w\\d]+)?)\\"+b+"(?<content>(.|\n)*?)\\k<prefix>\\"+p+"\\/\\k<name>\\"+b,"g");let r=0,c=[],i={};for(;(c=Array.from(this.#h.matchAll(e))).length>0;){const t=c[0],e="block_"+r;r++;const s=u+p+w+e+b;this.#h=this.#h.replace(t[0],s),i[e]=this.#O(t)}this.#k=Object.assign(this.#k,i),this.#w=!0}#O(t){const s=t.groups.prefix,r=t.groups.placeholder,l=Object.assign({},this.#k),u=new C(t.groups.content,l);switch(s){case d.CONDITIONAL:return s=>new e((()=>{const e=this.#f(r,s),n=!e||Object.hasOwn(e,"length")&&0===e.length||"object"==typeof e&&0===Object.keys(e).length,c=t.groups.operator===k;return n&&c||!n&&!c}),u,new i(""));case d.REPEATING:return()=>{const t=r.split(n),e=t.at(0),s=r.includes(n)?t.at(1):"";return new c(e,u,(t=>t),s)};case d.TAB_INDENTED:case d.SPACE_INDENTED:return()=>{const t=r.includes(n)?parseInt(r.split(n).at(1)):0;return new a(u,s===d.TAB_INDENTED?o.TAB:o.SPACE,t)};case d.CACHED:return()=>{const t="cached_"+r.split(n).at(0);return Object.hasOwn(this.#k,t)||(this.#k[t]=new h(u)),this.#k[t]};default:throw new SyntaxError('unhandled prefix "'+s+'"')}}}return{Block:t,Composite:class extends t{#j;constructor(t){super(),this.#j=t}render(t){return this.#j.map((e=>e.render(t))).join("")}},Conditional:e,Repeating:c,Simple:i,Callback:class extends t{#T;constructor(t){super(),this.#T=t}render(t){return this.#T(t)}},Cached:h,IndentType:o,Indented:a,Template:C}}();