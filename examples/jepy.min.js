var jepy=function(){"use strict";class t{render(){}}class e extends t{#t;#e;#r;constructor(t,e,r){super(),this.#t=t,this.#e=e,this.#r=r}render(t){return this.#t(t)?this.#e.render(t):this.#r?this.#r.render(t):""}}const r=".",s=":",n="|",c=(t,e)=>t.includes(r)?t.split(r).reduce((t,e)=>t?.[e],e):e[t];class i extends t{#s;#n;#c;#i;constructor(t,e,r,s=""){super(),this.#s=t,this.#c=e,this.#i=r,this.#n=s}render(t){let e=c(this.#s,t);const r=e.length,s=r-1;return e.map((e,n)=>{this.#n&&(e={[this.#n]:e}),this.#i&&(e=this.#i(e,t));let c=Object.assign({},t,e);return c.loop={index:n,first:0===n,last:n===s,number:n+1,size:r},this.#c.render(c)}).join("")}}class a extends t{#a;constructor(t){super(),this.#a=t}render(){return this.#a}}class h extends t{#h;#o;#l=null;#u={};constructor(t,e){super(),this.#h=t,this.#o=e||(()=>!0)}render(t){return null!==this.#l&&this.#o(t,this.#u)||(this.#l=this.#h.render(t)),this.#u=t,this.#l}}const o={SPACE:" ",TAB:"\t"};class l extends t{#p;#d;#b;constructor(t,e,r){super(),this.#p=t,this.#d=e,this.#b=r}render(t){const e=String().padStart(this.#b,this.#d);return this.#p.render(t).replace(new RegExp("^","gm"),e)}}const u={ESCAPED:"$",RAW:"%"},p={REPEATING:"#",CONDITIONAL:"?",TAB_INDENTED:">",SPACE_INDENTED:"_",CACHED:"="},d="{",b="}",f="",w="!",x="@",k="stringify",E="upper",m="lower",C="capitalize",g="trim",F="abs",O="round",j="floor",y="ceil",D="first",T="last",A="min",I="max";class N{#a="";#f={};constructor(t,e={}){this.#a=t,this.#f=e,this.#w()}render(t={}){let e=this.#a;const r=new RegExp("(?<indent>[ \\t]*)(?<placeholder>(?<prefix>[\\"+Object.values(u).join("\\")+"])\\"+d+"(?<path>[^\\"+b+"\\|]*)(\\"+n+"(?<filter>[^\\"+b+"\\|]+))?\\"+b+")","m");let s;for(;s=r.exec(e);){let r=this.#x(s.groups.path,t);s.groups.filter&&(r=this.#k(s.groups.filter,r)),"string"==typeof r&&(s.groups.prefix===u.ESCAPED&&(r=this.#E(r)),s.groups.indent&&r.includes("\n")&&(r=r.replace(new RegExp("\\n","g"),"\n"+s.groups.indent))),e=e.replaceAll(s.groups.placeholder,r)}return e}#k(t,e){switch(t){case k:return JSON.stringify(e);case m:return e.toLowerCase();case E:return e.toUpperCase();case C:return e.at(0).toUpperCase()+e.slice(1);case g:return e.trim();case F:return Math.abs(parseFloat(e));case O:return Math.round(parseFloat(e));case j:return Math.floor(parseFloat(e));case y:return Math.ceil(parseFloat(e));case D:return e.at(0);case T:return e.at(-1);case A:return Math.min(...e);case I:return Math.max(...e);default:throw new SyntaxError('unhandled filter "'+t+'"')}}#x(t,e){return t.startsWith(x)?this.#m(t,e):c(t,e)}#m(e,r){const s=e.slice(1);let n=c(s,this.#f);"function"==typeof n&&(n=n(r));return"object"==typeof n&&n instanceof t?n.render(r):n}#E(t){return t.replace(/([<>&]|[^#-~| |!])/g,t=>"&#"+t.charCodeAt(0)+";").replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t=>"&#"+(1024*t.charCodeAt(0)+t.charCodeAt(1)-56613888)+";")}#w(){const t=new RegExp("(?<prefix>[\\"+Object.values(p).join("\\")+"])\\"+d+"(?<operator>[\\"+w+"])?(?<placeholder>(?<name>[^\\"+s+"\\"+b+"]*)(?:\\"+s+"[^\\"+b+"]+)?)\\"+b+"(?<content>(.|\n)*?)\\k<prefix>\\"+d+"\\/\\k<name>\\"+b,"m");let e=0,r=[],n={};for(;r=t.exec(this.#a);){const t="block_"+e;e++;const s=u.RAW+d+x+t+b;this.#a=this.#a.replace(r[0],s),n[t]=this.#C(r)}this.#f=Object.assign(this.#f,n)}#C(t){const r=t.groups.prefix,n=t.groups.placeholder,u=Object.assign({},this.#f);switch(r){case p.CONDITIONAL:return r=>{let s=t.groups.content,c=new a("");const i=t.groups.operator===w,h=p.CONDITIONAL+d+(i?f:w)+n+b;if(s.includes(h)){const t=s.split(h);s=t[0],c=new N(t[1],u)}return new e(()=>{const t=this.#x(n,r),e=!t||Object.hasOwn(t,"length")&&0===t.length||"object"==typeof t&&0===Object.keys(t).length;return e&&i||!e&&!i},new N(s,u),c)};case p.REPEATING:return()=>{const e=n.split(s),r=e.at(0),c=n.includes(s)?e.at(1):"";return new i(r,new N(t.groups.content,u),t=>t,c)};case p.TAB_INDENTED:case p.SPACE_INDENTED:return()=>{const e=n.includes(s)?parseInt(n.split(s).at(1)):0;return new l(new N(t.groups.content,u),r===p.TAB_INDENTED?o.TAB:o.SPACE,e)};case p.CACHED:return()=>{const e=n.split(s),r="cached_"+e.at(0),i=n.includes(s)?(t,r)=>{const s=e.at(1);return s.startsWith(x)?c(s.slice(1),this.#f)(t,r):c(s,t)}:()=>!0;return Object.hasOwn(this.#f,r)||(this.#f[r]=new h(new N(t.groups.content,u),i)),this.#f[r]};default:throw new SyntaxError('unhandled prefix "'+r+'"')}}}return{Block:t,Composite:class extends t{#g;constructor(t){super(),this.#g=t}render(t){return this.#g.map(e=>e.render(t)).join("")}},Conditional:e,Repeating:i,Simple:a,Callback:class extends t{#F;constructor(t){super(),this.#F=t}render(t){return this.#F(t)}},Cached:h,IndentType:o,Indented:l,Template:N}}();